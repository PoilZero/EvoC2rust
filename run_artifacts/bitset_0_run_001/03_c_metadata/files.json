{
    "src/bitset.c": {
        "includes": [
            "#include \"./include/cborg/bitset.h\"",
            "#include <errno.h>"
        ],
        "macros": [],
        "macro_functions": [],
        "types": {
            "": []
        },
        "global_variables": {},
        "declarations": [],
        "functions": {
            "cb_bitset_new": "bitset_t *cb_bitset_new(size_t nb_bits)\n{\n    bitset_t *bs = (bitset_t *)calloc(1, sizeof(bitset_t));\n    bs->array = (uint8_t *)calloc(__bitset_size(nb_bits), sizeof(uint8_t));\n    bs->size = nb_bits;\n    return bs;\n}",
            "cb_bitset_delete": "void cb_bitset_delete(bitset_t *bs)\n{\n    free(bs->array);\n    free(bs);\n}",
            "cb_bitset_count": "size_t cb_bitset_count(bitset_t *bs)\n{\n    return (bs->flip ? (bs->size - bs->count) : bs->count);\n}",
            "cb_bitset_size": "size_t cb_bitset_size(bitset_t *bs)\n{\n    return bs->size;\n}",
            "cb_bitset_test": "bool cb_bitset_test(bitset_t *bs, size_t idx)\n{\n    return bs->flip ^ ((bs->array[__bitset_byte(idx)] & __bitset_bit_mask(idx)) != 0);\n}",
            "cb_bitset_any": "bool cb_bitset_any(bitset_t *bs)\n{\n    return (bs->flip ? (bs->count != bs->size) : (bs->count != 0));\n}",
            "cb_bitset_none": "bool cb_bitset_none(bitset_t *bs)\n{\n    return !(cb_bitset_any(bs));\n}",
            "cb_bitset_all": "bool cb_bitset_all(bitset_t *bs)\n{\n    return (bs->flip ? (bs->count == 0) : (bs->count == bs->size));\n}",
            "cb_bitset_set": "void cb_bitset_set(bitset_t *bs, size_t idx, bool value)\n{\n    bool flip_value = bs->flip ? !value : value;\n    size_t previous_count = __builtin_popcount(bs->array[__bitset_byte(idx)]);\n    if (flip_value)\n    {\n        bs->array[__bitset_byte(idx)] |= __bitset_bit_mask(idx);\n    }\n    else\n    {\n        bs->array[__bitset_byte(idx)] &= ~__bitset_bit_mask(idx);\n    }\n    bs->count += (__builtin_popcount(bs->array[__bitset_byte(idx)]) - previous_count);\n}",
            "cb_bitset_reset": "void cb_bitset_reset(bitset_t *bs)\n{\n    memset(bs->array, 0, __bitset_size(bs->size));\n    bs->flip = false;\n    bs->count = 0;\n}",
            "cb_bitset_flip": "void cb_bitset_flip(bitset_t *bs)\n{\n    bs->flip = !(bs->flip);\n}",
            "cb_bitset_to_string": "char *cb_bitset_to_string(bitset_t *bs)\n{\n    char *res = (char *)malloc(sizeof(char) * (bs->size + 1));\n    for (size_t i = 0; i < bs->size; i++)\n    {\n        res[i] = cb_bitset_test(bs, i) ? '1' : '0';\n    }\n    res[bs->size] = '\\0';\n    return res;\n}",
            "cb_bitset_write": "void cb_bitset_write(bitset_t *bs, const char *path)\n{\n    FILE *file = fopen(path, \"wb\");\n    size_t bytes_to_write = __bitset_size(bs->size);\n    size_t bytes_writen = 0;\n    size_t total_writen = 0;\n\n    if (file == NULL)\n    {\n        fprintf(stdout, \"%s\\n\", strerror(errno));\n        exit(EXIT_FAILURE);\n    }\n\n    fwrite(&(bs->size), sizeof(size_t), 1, file);\n    fwrite(&(bs->count), sizeof(size_t), 1, file);\n    fwrite(&(bs->flip), sizeof(bool), 1, file);\n    while ((bytes_writen = fwrite(bs->array + total_writen, sizeof(uint8_t), bytes_to_write - total_writen, file)) > 0)\n    {\n        total_writen += bytes_writen;\n    }\n\n    fclose(file);\n}",
            "cb_bitset_read": "bitset_t *cb_bitset_read(const char *path)\n{\n    FILE *file = fopen(path, \"rb\");\n    size_t size = 0;\n\n    if (file == NULL)\n    {\n        fprintf(stdout, \"%s\\n\", strerror(errno));\n        exit(EXIT_FAILURE);\n    }\n\n    fread(&size, sizeof(size_t), 1, file);\n    bitset_t *bs = cb_bitset_new(size);\n    fread(&(bs->count), sizeof(size_t), 1, file);\n    fread(&(bs->flip), sizeof(bool), 1, file);\n    while (fread(bs->array, sizeof(uint8_t), bs->size, file) > 0)\n        ;\n\n    fclose(file);\n    return bs;\n}"
        }
    },
    "src/include/cborg/bitset.h": {
        "includes": [
            "#include <stdbool.h>",
            "#include <stdint.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
        ],
        "macros": [
            "#define _CBORG_BITSET_H"
        ],
        "macro_functions": [
            "#define __bitset_size(nbits) ((nbits + 7) >> 3)",
            "#define __bitset_byte(idx) ((idx) >> 3)",
            "#define __bitset_bit_mask(idx) (1 << ((idx)&0x7))"
        ],
        "types": {
            "": [],
            "bitset_t": "typedef struct bitset_t\n{\n    bool flip;\n    size_t size;\n    size_t count;\n    uint8_t *array;\n} bitset_t;"
        },
        "global_variables": {},
        "declarations": [
            "bitset_t",
            "cb_bitset_test",
            "cb_bitset_new",
            "cb_bitset_flip",
            "cb_bitset_delete",
            "cb_bitset_count",
            "cb_bitset_none",
            "cb_bitset_reset",
            "cb_bitset_to_string",
            "cb_bitset_all",
            "cb_bitset_read",
            "cb_bitset_any",
            "cb_bitset_size",
            "cb_bitset_write",
            "cb_bitset_set"
        ],
        "functions": {}
    }
}
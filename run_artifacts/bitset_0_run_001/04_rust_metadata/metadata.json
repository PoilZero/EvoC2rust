{
    "src": {
        "name": "src",
        "type": "folder",
        "children": {
            "bitset_c.rs": {
                "name": "bitset_c.rs",
                "type": "file",
                "declarations": [
                    "use crate::translation_utils::*;"
                ],
                "definitions": [],
                "macros": [],
                "macro_functions": [],
                "functions": [
                    {
                        "c_code": "bitset_t *cb_bitset_new(size_t nb_bits)\n{\n    bitset_t *bs = (bitset_t *)calloc(1, sizeof(bitset_t));\n    bs->array = (uint8_t *)calloc(__bitset_size(nb_bits), sizeof(uint8_t));\n    bs->size = nb_bits;\n    return bs;\n}",
                        "rust_code": "pub fn cb_bitset_new() { unimplemented!(); }"
                    },
                    {
                        "c_code": "void cb_bitset_delete(bitset_t *bs)\n{\n    free(bs->array);\n    free(bs);\n}",
                        "rust_code": "pub fn cb_bitset_delete() { unimplemented!(); }"
                    },
                    {
                        "c_code": "size_t cb_bitset_count(bitset_t *bs)\n{\n    return (bs->flip ? (bs->size - bs->count) : bs->count);\n}",
                        "rust_code": "pub fn cb_bitset_count() { unimplemented!(); }"
                    },
                    {
                        "c_code": "size_t cb_bitset_size(bitset_t *bs)\n{\n    return bs->size;\n}",
                        "rust_code": "pub fn cb_bitset_size() { unimplemented!(); }"
                    },
                    {
                        "c_code": "bool cb_bitset_test(bitset_t *bs, size_t idx)\n{\n    return bs->flip ^ ((bs->array[__bitset_byte(idx)] & __bitset_bit_mask(idx)) != 0);\n}",
                        "rust_code": "pub fn cb_bitset_test() { unimplemented!(); }"
                    },
                    {
                        "c_code": "bool cb_bitset_any(bitset_t *bs)\n{\n    return (bs->flip ? (bs->count != bs->size) : (bs->count != 0));\n}",
                        "rust_code": "pub fn cb_bitset_any() { unimplemented!(); }"
                    },
                    {
                        "c_code": "bool cb_bitset_none(bitset_t *bs)\n{\n    return !(cb_bitset_any(bs));\n}",
                        "rust_code": "pub fn cb_bitset_none() { unimplemented!(); }"
                    },
                    {
                        "c_code": "bool cb_bitset_all(bitset_t *bs)\n{\n    return (bs->flip ? (bs->count == 0) : (bs->count == bs->size));\n}",
                        "rust_code": "pub fn cb_bitset_all() { unimplemented!(); }"
                    },
                    {
                        "c_code": "void cb_bitset_set(bitset_t *bs, size_t idx, bool value)\n{\n    bool flip_value = bs->flip ? !value : value;\n    size_t previous_count = __builtin_popcount(bs->array[__bitset_byte(idx)]);\n    if (flip_value)\n    {\n        bs->array[__bitset_byte(idx)] |= __bitset_bit_mask(idx);\n    }\n    else\n    {\n        bs->array[__bitset_byte(idx)] &= ~__bitset_bit_mask(idx);\n    }\n    bs->count += (__builtin_popcount(bs->array[__bitset_byte(idx)]) - previous_count);\n}",
                        "rust_code": "pub fn cb_bitset_set() { unimplemented!(); }"
                    },
                    {
                        "c_code": "void cb_bitset_reset(bitset_t *bs)\n{\n    memset(bs->array, 0, __bitset_size(bs->size));\n    bs->flip = false;\n    bs->count = 0;\n}",
                        "rust_code": "pub fn cb_bitset_reset() { unimplemented!(); }"
                    },
                    {
                        "c_code": "void cb_bitset_flip(bitset_t *bs)\n{\n    bs->flip = !(bs->flip);\n}",
                        "rust_code": "pub fn cb_bitset_flip() { unimplemented!(); }"
                    },
                    {
                        "c_code": "char *cb_bitset_to_string(bitset_t *bs)\n{\n    char *res = (char *)malloc(sizeof(char) * (bs->size + 1));\n    for (size_t i = 0; i < bs->size; i++)\n    {\n        res[i] = cb_bitset_test(bs, i) ? '1' : '0';\n    }\n    res[bs->size] = '\\0';\n    return res;\n}",
                        "rust_code": "pub fn cb_bitset_to_string() { unimplemented!(); }"
                    },
                    {
                        "c_code": "void cb_bitset_write(bitset_t *bs, const char *path)\n{\n    FILE *file = fopen(path, \"wb\");\n    size_t bytes_to_write = __bitset_size(bs->size);\n    size_t bytes_writen = 0;\n    size_t total_writen = 0;\n\n    if (file == NULL)\n    {\n        fprintf(stdout, \"%s\\n\", strerror(errno));\n        exit(EXIT_FAILURE);\n    }\n\n    fwrite(&(bs->size), sizeof(size_t), 1, file);\n    fwrite(&(bs->count), sizeof(size_t), 1, file);\n    fwrite(&(bs->flip), sizeof(bool), 1, file);\n    while ((bytes_writen = fwrite(bs->array + total_writen, sizeof(uint8_t), bytes_to_write - total_writen, file)) > 0)\n    {\n        total_writen += bytes_writen;\n    }\n\n    fclose(file);\n}",
                        "rust_code": "pub fn cb_bitset_write() { unimplemented!(); }"
                    },
                    {
                        "c_code": "bitset_t *cb_bitset_read(const char *path)\n{\n    FILE *file = fopen(path, \"rb\");\n    size_t size = 0;\n\n    if (file == NULL)\n    {\n        fprintf(stdout, \"%s\\n\", strerror(errno));\n        exit(EXIT_FAILURE);\n    }\n\n    fread(&size, sizeof(size_t), 1, file);\n    bitset_t *bs = cb_bitset_new(size);\n    fread(&(bs->count), sizeof(size_t), 1, file);\n    fread(&(bs->flip), sizeof(bool), 1, file);\n    while (fread(bs->array, sizeof(uint8_t), bs->size, file) > 0)\n        ;\n\n    fclose(file);\n    return bs;\n}",
                        "rust_code": "pub fn cb_bitset_read() { unimplemented!(); }"
                    }
                ]
            },
            "include": {
                "name": "include",
                "type": "folder",
                "children": {
                    "cborg": {
                        "name": "cborg",
                        "type": "folder",
                        "children": {
                            "bitset_h.rs": {
                                "name": "bitset_h.rs",
                                "type": "file",
                                "declarations": [
                                    "use crate::translation_utils::*;",
                                    "pub use crate::src::bitset_c::cb_bitset_test;",
                                    "pub use crate::src::bitset_c::cb_bitset_new;",
                                    "pub use crate::src::bitset_c::cb_bitset_flip;",
                                    "pub use crate::src::bitset_c::cb_bitset_delete;",
                                    "pub use crate::src::bitset_c::cb_bitset_count;",
                                    "pub use crate::src::bitset_c::cb_bitset_none;",
                                    "pub use crate::src::bitset_c::cb_bitset_reset;",
                                    "pub use crate::src::bitset_c::cb_bitset_to_string;",
                                    "pub use crate::src::bitset_c::cb_bitset_all;",
                                    "pub use crate::src::bitset_c::cb_bitset_read;",
                                    "pub use crate::src::bitset_c::cb_bitset_any;",
                                    "pub use crate::src::bitset_c::cb_bitset_size;",
                                    "pub use crate::src::bitset_c::cb_bitset_write;",
                                    "pub use crate::src::bitset_c::cb_bitset_set;"
                                ],
                                "definitions": [
                                    {
                                        "c_code": "typedef struct bitset_t\n{\n    bool flip;\n    size_t size;\n    size_t count;\n    uint8_t *array;\n} bitset_t;",
                                        "rust_code": "pub type bitset_t = i32;"
                                    }
                                ],
                                "macros": [
                                    {
                                        "c_code": "#define _CBORG_BITSET_H",
                                        "rust_code": ""
                                    }
                                ],
                                "macro_functions": [
                                    {
                                        "c_code": "#define __bitset_size(nbits) ((nbits + 7) >> 3)",
                                        "rust_code": ""
                                    },
                                    {
                                        "c_code": "#define __bitset_byte(idx) ((idx) >> 3)",
                                        "rust_code": ""
                                    },
                                    {
                                        "c_code": "#define __bitset_bit_mask(idx) (1 << ((idx)&0x7))",
                                        "rust_code": ""
                                    }
                                ],
                                "functions": []
                            },
                            "mod.rs": {
                                "name": "mod.rs",
                                "type": "file",
                                "declarations": [
                                    "pub mod bitset_h;"
                                ],
                                "definitions": [],
                                "macros": [],
                                "macro_functions": [],
                                "functions": []
                            }
                        }
                    },
                    "mod.rs": {
                        "name": "mod.rs",
                        "type": "file",
                        "declarations": [
                            "pub mod cborg;"
                        ],
                        "definitions": [],
                        "macros": [],
                        "macro_functions": [],
                        "functions": []
                    }
                }
            },
            "mod.rs": {
                "name": "mod.rs",
                "type": "file",
                "declarations": [
                    "pub mod bitset_c;",
                    "pub mod include;"
                ],
                "definitions": [],
                "macros": [],
                "macro_functions": [],
                "functions": []
            }
        }
    },
    "lib.rs": {
        "name": "lib.rs",
        "type": "file",
        "declarations": [
            "pub(crate) mod translation_utils;",
            "pub(crate) mod src;"
        ],
        "definitions": [],
        "macros": [],
        "macro_functions": [],
        "functions": []
    }
}